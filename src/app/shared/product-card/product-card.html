<!-- Make the entire card clickable for product details -->
<div class="card h-100 shadow-sm product-card">
  <div *ngIf="hasDiscount" class="position-absolute top-0 start-0 m-2">
    <span class="badge bg-danger">-{{ discountPercentage }}%</span>
  </div>

  <div class="position-absolute top-0 end-0 m-2 mybutton">
    <button class="btn btn-light btn-sm rounded-circle shadow" (click)="onToggle($event)">
      ♡
    </button>
  </div>

  <img [src]="mainImage" class="card-img-top p-3" [alt]="product().title" style="height: 200px; object-fit: contain;">

  <div class="card-body d-flex flex-column">
    <h6 class="card-title fw-bold">{{ product().title }}</h6>
    <span class="badge bg-secondary mb-2 align-self-start">{{ product().category.name }}</span>
    <span class="badge bg-light text-dark mb-2 align-self-start">{{ product().brand.name }}</span>

    <div class="mt-auto">
      <div class="d-flex align-items-center mb-2">
        <div class="text-warning small">
          ⭐ {{ product().ratingsAverage || 0 }}
          <small class="text-muted">({{ product().ratingsQuantity || 0 }})</small>
        </div>
      </div>

      <div class="d-flex justify-content-between align-items-center mb-2">
        <div>
          @if (!hasDiscount) {
          <span class="h5 text-primary mb-0">${{ product().price }}</span>
          } @else {
          <div>
            <span class="h5 text-primary mb-0">${{ product().priceAfterDiscount }}</span>
            <small class="text-muted text-decoration-line-through ms-2">${{ product().price }}</small>
          </div>
          }
        </div>
      </div>

      <div class="d-flex gap-2">
        <button class="btn btn-primary btn-sm flex-fill" (click)="onAddToCart($event)"
          [disabled]="product().quantity === 0">
          {{ product().quantity === 0 ? 'Out of Stock' : 'Add to Cart' }}
        </button>
      </div>

      
    </div>
  </div>
</div>