<div class="container py-5">
  @if (loading()) {
    <div class="text-center py-5">
      <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p class="mt-3 text-muted">Loading product details...</p>
    </div>
  }

  @if (error() && !loading()) {
    <div class="alert alert-danger text-center">
      {{ error() }}
      <button class="btn btn-outline-primary ms-2" routerLink="/products">Back to Products</button>
    </div>
  }

  @if (product() && !loading()) {
    <div class="row">
      <!-- Product Images -->
      <div class="col-md-6">
        <div class="main-image mb-4">
          <img [src]="mainImage" [alt]="getProductTitle()" class="img-fluid rounded-3 w-100">
        </div>
        
        @if (getProductImages().length > 1) {
          <div class="image-thumbnails d-flex gap-2 flex-wrap">
            @for (image of getProductImages(); track $index; let i = $index) {
              <img [src]="image" 
                   [alt]="getProductTitle() + ' thumbnail ' + ($index + 1)"
                   class="thumbnail img-fluid rounded-2"
                   [class.active]="i === selectedImageIndex()"
                   (click)="selectImage(i)"
                   style="width: 80px; height: 80px; object-fit: cover; cursor: pointer;">
            }
          </div>
        }
      </div>

      <!-- Product Info -->
      <div class="col-md-6">
        <nav aria-label="breadcrumb" class="mb-3">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a routerLink="/">Home</a></li>
            <li class="breadcrumb-item"><a routerLink="/products">Products</a></li>
            <li class="breadcrumb-item active">{{ getProductTitle() }}</li>
          </ol>
        </nav>

        <h1 class="h2 fw-bold mb-3">{{ getProductTitle() }}</h1>
        
        <div class="mb-3">
          <span class="badge bg-secondary me-2">{{ getProductCategory() }}</span>
          <span class="badge bg-light text-dark">{{ getProductBrand() }}</span>
        </div>

        <div class="rating mb-3">
          <span class="text-warning">⭐ {{ getProductRating() }}</span>
          <small class="text-muted ms-2">({{ getProductRatingCount() }} reviews)</small>
        </div>

        <p class="text-muted mb-4">{{ getProductDescription() }}</p>

        <div class="price-section mb-4">
          @if (hasDiscount()) {
            <div>
              <span class="h2 text-primary fw-bold">${{ getProductPriceAfterDiscount() }}</span>
              <span class="h4 text-muted text-decoration-line-through ms-2">${{ getProductPrice() }}</span>
              <span class="badge bg-danger ms-2">
                Save {{ getDiscountPercentage() }}%
              </span>
            </div>
          } @else {
            <span class="h2 text-primary fw-bold">${{ getProductPrice() }}</span>
          }
        </div>

        <div class="stock-info mb-4">
          @if (getProductQuantity() > 0) {
            <span class="text-success">✓ In Stock ({{ getProductQuantity() }} available)</span>
          } @else {
            <span class="text-danger">✗ Out of Stock</span>
          }
          <small class="text-muted d-block">Sold: {{ getProductSold() }}</small>
        </div>

        <div class="action-buttons d-flex gap-3">
          <button class="btn btn-primary btn-lg flex-fill" 
                  (click)="addToCart()"
                  [disabled]="getProductQuantity() === 0">
            {{ getProductQuantity() === 0 ? 'Out of Stock' : 'Add to Cart' }}
          </button>
          <button class="btn btn-outline-secondary btn-lg">
            <i class="bi bi-heart"></i>
          </button>
        </div>
      </div>
    </div>
  }
</div>