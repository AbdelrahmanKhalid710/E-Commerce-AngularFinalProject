<div class="container py-5">
  <!-- Header -->
  <div class="row mb-4">
    <div class="col-12">
      <nav aria-label="breadcrumb" class="mb-3">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a routerLink="/">Home</a></li>
          <li class="breadcrumb-item active">{{ currentCategoryName() }}</li> <!-- FIXED -->
        </ol>
      </nav>

      <div class="d-flex justify-content-between align-items-center">
        <div>
          <h1 class="h2 fw-bold">{{ currentCategoryName() }}</h1> <!-- FIXED -->
          <p class="text-muted mb-0">
            {{ products().length }} products found
            @if (currentCategoryId()) {
              <span class="text-primary"> in this category</span>
            }
          </p>
        </div>
        
        @if (currentCategoryId()) {
          <button class="btn btn-outline-secondary" (click)="clearFilters()">
            View All Products
          </button>
        }
      </div>
    </div>
  </div>

  <!-- Debug Info (remove in production) -->
  <!-- @if (currentCategoryId()) {
    <div class="alert alert-info mb-4">
      <small>
        <strong>Filtering by Category ID:</strong> {{ currentCategoryId() }}<br>
        <strong>Category Name:</strong> {{ currentCategoryName() }}<br>  FIXED 
        <strong>Products Found:</strong> {{ products().length }}
      </small>
    </div>
  } -->

  <!-- Loading State -->
  @if (loading()) {
    <div class="text-center py-5">
      <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p class="mt-3 text-muted">Loading products...</p>
    </div>
  }

  <!-- Error State -->
  @if (error() && !loading()) {
    <div class="alert alert-warning text-center">
      {{ error() }}
      <button class="btn btn-sm btn-outline-primary ms-2" (click)="loadProducts(currentCategoryId() || undefined)">
        Try Again
      </button>
    </div>
  }

  <!-- Products Grid -->
  @if (!loading() && !error()) {
    <div class="row g-4">
      @for (product of products(); track product._id) {
        <div class="col-xl-3 col-lg-4 col-md-6">
          <app-product-card 
            [product]="product"
            (addToCart)="onAddToCart($event)"
            (toggleFavorite)="onToggleFavorite($event)">
          </app-product-card>
        </div>
      }
    </div>

    <!-- Empty State -->
    @if (products().length === 0 && currentCategoryId()) {
      <div class="text-center py-5">
        <i class="bi bi-search display-1 text-muted"></i>
        <h3 class="text-muted mt-3">No products found in "{{ currentCategoryName() }}"</h3> <!-- FIXED -->
        <p class="text-muted mb-4">Try browsing all products or check other categories</p>
        <button class="btn btn-primary" (click)="clearFilters()">
          View All Products
        </button>
      </div>
    }

    @if (products().length === 0 && !currentCategoryId()) {
      <div class="text-center py-5">
        <i class="bi bi-inbox display-1 text-muted"></i>
        <h3 class="text-muted mt-3">No products available</h3>
        <p class="text-muted">Check back later for new arrivals</p>
      </div>
    }
  }
</div>