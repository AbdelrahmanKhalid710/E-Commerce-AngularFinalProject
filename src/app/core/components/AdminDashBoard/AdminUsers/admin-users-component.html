<div class="admin-page-header">
  <h2>Users Management</h2>
  <div class="admin-stats">
    <span class="admin-stat-badge">Total Users: {{ totalUsers }}</span>
    <span class="admin-stat-badge">Active: {{ getActiveUsersCount() }}</span>
    <span class="admin-stat-badge">Page: {{ currentPage }} of {{ totalPages }}</span>
  </div>
</div>

<div class="admin-table-container card">
  <div class="admin-table-header">
    <h3>All Users ({{ totalUsers }} total)</h3>
    <div class="admin-table-actions">
      <button class="btn-admin-refresh" (click)="loadAdminUsers()">
        <i class="fas fa-sync-alt"></i>
        Refresh
      </button>
    </div>
  </div>

  <!-- Enhanced table -->
  <div class="table-responsive">
    <table class="admin-data-table">
      <thead>
        <tr>
          <th class="col-user-id">User ID</th>
          <th class="col-name">Name</th>
          <th class="col-email">Email</th>
          <th class="col-date">Registration Date</th>
        </tr>
      </thead>
      <tbody>
        @for (user of adminUsers; track user._id; let i = $index) {
          <tr [class.even-row]="i % 2 === 0">
            <td class="user-id-cell">
              <div class="user-id-wrapper">
                <span class="id-prefix">#</span>
                {{ user._id!.slice(-8) || 'N/A' }}
              </div>
            </td>

            <td class="name-cell">
              <div class="user-name-wrapper">
                <div class="name-text">{{ user.name }}</div>
              </div>
            </td>

            <td class="email-cell">
              <div class="email-wrapper">
                <i class="fas fa-envelope email-icon"></i>
                {{ user.email }}
              </div>
            </td>

            <td class="date-cell">
              <div class="date-wrapper">
                <div class="date-full">{{ user.createdAt | date: 'mediumDate' }}</div>
                <div class="date-time">{{ user.createdAt | date: 'shortTime' }}</div>
              </div>
            </td>
          </tr>
        }
        
        <!-- Loading State -->
        @if (adminLoading && adminUsers.length === 0) {
          <tr>
            <td colspan="4">
              <div class="admin-loading">
                <div class="loading-content">
                  <div class="admin-loading-spinner"></div>
                  <div class="loading-text">Loading Users...</div>
                </div>
              </div>
            </td>
          </tr>
        }
        
        <!-- Empty State -->
        @if (!adminLoading && adminUsers.length === 0) {
          <tr>
            <td colspan="4">
              <div class="admin-empty">
                <div class="empty-content">
                  <i class="fas fa-users empty-icon"></i>
                  <div class="empty-text">No Users Found</div>
                </div>
              </div>
            </td>
          </tr>
        }
      </tbody>
    </table>
  </div>

  <!-- Pagination -->
  @if (totalPages > 1) {
    <div class="admin-pagination">
      <div class="pagination-controls">
        <button
          class="btn-pagination btn-prev"
          [disabled]="currentPage === 1"
          (click)="goToPage(currentPage - 1)"
        >
          <i class="fas fa-chevron-left"></i>
          Previous
        </button>

        <div class="pagination-info">
          Page <strong>{{ currentPage }}</strong> of <strong>{{ totalPages }}</strong>
        </div>

        <button
          class="btn-pagination btn-next"
          [disabled]="currentPage === totalPages"
          (click)="goToPage(currentPage + 1)"
        >
          Next
          <i class="fas fa-chevron-right"></i>
        </button>
      </div>
    </div>
  }

  <!-- Error State -->
  @if (adminError) {
    <div class="admin-error">
      <div class="error-content">
        <i class="fas fa-exclamation-triangle error-icon"></i>
        <div class="error-text">{{ adminError }}</div>
        <button class="btn-admin-retry" (click)="loadAdminUsers()">
          <i class="fas fa-redo"></i>
          Retry
        </button>
      </div>
    </div>
  }
</div>