<section class="categories-section py-5 bg-light">
  <div class="container">
    <h2 class="text-center mb-5 fw-bold">Shop by Category</h2>
    
    @if (loading()) {
      <div class="text-center py-4">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
        <p class="mt-2 text-muted">Loading categories...</p>
      </div>
    }

    @if (error() && !loading()) {
      <div class="alert alert-warning text-center">
        {{ error() }}
      </div>
    }

    @if (!loading() && !error()) {
      <div class="row g-4">
        @for (category of categories(); track category._id) {
          <div class="col-lg-2 col-md-4 col-sm-6">
            <div class="category-card text-center">
              <div class="category-image-wrapper mb-3">
                <img [src]="getCategoryImage(category)" [alt]="category.name" 
                     class="category-image rounded-circle shadow">
              </div>
              <h6 class="fw-bold mb-1">{{ category.name }}</h6>
              <!-- UPDATED: Pass category ID and name -->
              <a [routerLink]="['/products']" 
                 [queryParams]="{categoryId: category._id, categoryName: category.name}" 
                 class="btn btn-outline-primary btn-sm">
                Shop Now
              </a>
            </div>
          </div>
        }
      </div>
    }
  </div>
</section>